{"ast":null,"code":"var elliptic=require('elliptic');var BN=require('bn.js');module.exports=function createECDH(curve){return new ECDH(curve);};var aliases={secp256k1:{name:'secp256k1',byteLength:32},secp224r1:{name:'p224',byteLength:28},prime256v1:{name:'p256',byteLength:32},prime192v1:{name:'p192',byteLength:24},ed25519:{name:'ed25519',byteLength:32},secp384r1:{name:'p384',byteLength:48},secp521r1:{name:'p521',byteLength:66}};aliases.p224=aliases.secp224r1;aliases.p256=aliases.secp256r1=aliases.prime256v1;aliases.p192=aliases.secp192r1=aliases.prime192v1;aliases.p384=aliases.secp384r1;aliases.p521=aliases.secp521r1;function ECDH(curve){this.curveType=aliases[curve];if(!this.curveType){this.curveType={name:curve};}this.curve=new elliptic.ec(this.curveType.name);this.keys=void 0;}ECDH.prototype.generateKeys=function(enc,format){this.keys=this.curve.genKeyPair();return this.getPublicKey(enc,format);};ECDH.prototype.computeSecret=function(other,inenc,enc){inenc=inenc||'utf8';if(!Buffer.isBuffer(other)){other=new Buffer(other,inenc);}var otherPub=this.curve.keyFromPublic(other).getPublic();var out=otherPub.mul(this.keys.getPrivate()).getX();return formatReturnValue(out,enc,this.curveType.byteLength);};ECDH.prototype.getPublicKey=function(enc,format){var key=this.keys.getPublic(format==='compressed',true);if(format==='hybrid'){if(key[key.length-1]%2){key[0]=7;}else{key[0]=6;}}return formatReturnValue(key,enc);};ECDH.prototype.getPrivateKey=function(enc){return formatReturnValue(this.keys.getPrivate(),enc);};ECDH.prototype.setPublicKey=function(pub,enc){enc=enc||'utf8';if(!Buffer.isBuffer(pub)){pub=new Buffer(pub,enc);}this.keys._importPublic(pub);return this;};ECDH.prototype.setPrivateKey=function(priv,enc){enc=enc||'utf8';if(!Buffer.isBuffer(priv)){priv=new Buffer(priv,enc);}var _priv=new BN(priv);_priv=_priv.toString(16);this.keys=this.curve.genKeyPair();this.keys._importPrivate(_priv);return this;};function formatReturnValue(bn,enc,len){if(!Array.isArray(bn)){bn=bn.toArray();}var buf=new Buffer(bn);if(len&&buf.length<len){var zeros=new Buffer(len-buf.length);zeros.fill(0);buf=Buffer.concat([zeros,buf]);}if(!enc){return buf;}else{return buf.toString(enc);}}","map":{"version":3,"sources":["/usr/local/lib/node_modules/expo-cli/node_modules/create-ecdh/browser.js"],"names":["elliptic","require","BN","module","exports","createECDH","curve","ECDH","aliases","secp256k1","name","byteLength","secp224r1","prime256v1","prime192v1","ed25519","secp384r1","secp521r1","p224","p256","secp256r1","p192","secp192r1","p384","p521","curveType","ec","keys","prototype","generateKeys","enc","format","genKeyPair","getPublicKey","computeSecret","other","inenc","Buffer","isBuffer","otherPub","keyFromPublic","getPublic","out","mul","getPrivate","getX","formatReturnValue","key","length","getPrivateKey","setPublicKey","pub","_importPublic","setPrivateKey","priv","_priv","toString","_importPrivate","bn","len","Array","isArray","toArray","buf","zeros","fill","concat"],"mappings":"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","sourcesContent":["var elliptic = require('elliptic')\nvar BN = require('bn.js')\n\nmodule.exports = function createECDH (curve) {\n  return new ECDH(curve)\n}\n\nvar aliases = {\n  secp256k1: {\n    name: 'secp256k1',\n    byteLength: 32\n  },\n  secp224r1: {\n    name: 'p224',\n    byteLength: 28\n  },\n  prime256v1: {\n    name: 'p256',\n    byteLength: 32\n  },\n  prime192v1: {\n    name: 'p192',\n    byteLength: 24\n  },\n  ed25519: {\n    name: 'ed25519',\n    byteLength: 32\n  },\n  secp384r1: {\n    name: 'p384',\n    byteLength: 48\n  },\n  secp521r1: {\n    name: 'p521',\n    byteLength: 66\n  }\n}\n\naliases.p224 = aliases.secp224r1\naliases.p256 = aliases.secp256r1 = aliases.prime256v1\naliases.p192 = aliases.secp192r1 = aliases.prime192v1\naliases.p384 = aliases.secp384r1\naliases.p521 = aliases.secp521r1\n\nfunction ECDH (curve) {\n  this.curveType = aliases[curve]\n  if (!this.curveType) {\n    this.curveType = {\n      name: curve\n    }\n  }\n  this.curve = new elliptic.ec(this.curveType.name) // eslint-disable-line new-cap\n  this.keys = void 0\n}\n\nECDH.prototype.generateKeys = function (enc, format) {\n  this.keys = this.curve.genKeyPair()\n  return this.getPublicKey(enc, format)\n}\n\nECDH.prototype.computeSecret = function (other, inenc, enc) {\n  inenc = inenc || 'utf8'\n  if (!Buffer.isBuffer(other)) {\n    other = new Buffer(other, inenc)\n  }\n  var otherPub = this.curve.keyFromPublic(other).getPublic()\n  var out = otherPub.mul(this.keys.getPrivate()).getX()\n  return formatReturnValue(out, enc, this.curveType.byteLength)\n}\n\nECDH.prototype.getPublicKey = function (enc, format) {\n  var key = this.keys.getPublic(format === 'compressed', true)\n  if (format === 'hybrid') {\n    if (key[key.length - 1] % 2) {\n      key[0] = 7\n    } else {\n      key[0] = 6\n    }\n  }\n  return formatReturnValue(key, enc)\n}\n\nECDH.prototype.getPrivateKey = function (enc) {\n  return formatReturnValue(this.keys.getPrivate(), enc)\n}\n\nECDH.prototype.setPublicKey = function (pub, enc) {\n  enc = enc || 'utf8'\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc)\n  }\n  this.keys._importPublic(pub)\n  return this\n}\n\nECDH.prototype.setPrivateKey = function (priv, enc) {\n  enc = enc || 'utf8'\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc)\n  }\n\n  var _priv = new BN(priv)\n  _priv = _priv.toString(16)\n  this.keys = this.curve.genKeyPair()\n  this.keys._importPrivate(_priv)\n  return this\n}\n\nfunction formatReturnValue (bn, enc, len) {\n  if (!Array.isArray(bn)) {\n    bn = bn.toArray()\n  }\n  var buf = new Buffer(bn)\n  if (len && buf.length < len) {\n    var zeros = new Buffer(len - buf.length)\n    zeros.fill(0)\n    buf = Buffer.concat([zeros, buf])\n  }\n  if (!enc) {\n    return buf\n  } else {\n    return buf.toString(enc)\n  }\n}\n"]},"metadata":{},"sourceType":"script"}